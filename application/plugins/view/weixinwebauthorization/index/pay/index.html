<script type="text/javascript">
function onBridgeReady()
{
   WeixinJSBridge.invoke(
      'getBrandWCPayRequest', {
         "appId":"{{$pay_data.appId}}",
         "timeStamp":"{{$pay_data.timeStamp}}",
         "nonceStr":"{{$pay_data.nonceStr}}",
         "package":"{{$pay_data.package}}",     
         "signType":"{{$pay_data.signType}}",
         "paySign":"{{$pay_data.paySign}}"
      },
      function(res) {
      if(res.err_msg == "get_brand_wcpay_request:ok" )
      {
        Prompt(result.msg, 'success');
        {{if !empty($redirect_url)}}
            setTimeout(function()
            {
                window.location.href = '{{$redirect_url}}';
            }, 1500);
        {{/if}}
      } else if(res.err_msg == 'get_brand_wcpay_request:cancel')
      {
        Prompt('用户取消');
      } else if(res.err_msg == 'get_brand_wcpay_request:fail')
      {
        Prompt('支付失败');
      } else {
        Prompt('支付参数有误');
      }
   }); 
}
if(typeof WeixinJSBridge == "undefined")
{
   if( document.addEventListener )
   {
       document.addEventListener('WeixinJSBridgeReady', onBridgeReady, false);
   } else if (document.attachEvent)
   {
       document.attachEvent('WeixinJSBridgeReady', onBridgeReady); 
       document.attachEvent('onWeixinJSBridgeReady', onBridgeReady);
   }
} else {
   onBridgeReady();
}
</script>